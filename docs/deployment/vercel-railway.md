# Deploy B(Project2) with Vercel + Railway

## Topology

- Frontend: `apps/web` deployed on Vercel
- Backend API: `api/server.js` deployed on Railway
- Content source: `content/posts/*.md` generated by GitHub Actions (`Autopost`)

## 1) Railway (Backend API)

Create a Railway service from this repo and configure:

- Start command: `npm run api:start`
- Root directory: repository root (`.`)

Set environment variables:

- `CORS_ORIGIN=https://<your-vercel-domain>`
- `POSTS_DIR=content/posts` (default, optional)

Health check:

- `GET https://<railway-domain>/healthz`

## 2) Vercel (Frontend)

Import this repo in Vercel with:

- Root Directory: `apps/web`
- Framework Preset: Next.js

Set environment variables:

- `NEXT_PUBLIC_API_BASE_URL=https://<your-railway-domain>`
- `NEXT_PUBLIC_SERVICE_A_NAME=<A service name>`
- `NEXT_PUBLIC_SERVICE_A_URL=https://<A service URL>`

## 3) Connect Autopost Loop

`Autopost` workflow commits generated posts to `main`.

- Ensure Railway and Vercel are connected to same repo branch (`main`).
- On each autopost commit, both services should redeploy automatically.

## 4) Required GitHub Repo Variables

For `.github/workflows/autopost.yml`:

- `SERVICE_A_NAME`
- `SERVICE_A_URL`

## 5) Validation Checklist

1. `https://<railway-domain>/healthz` returns `{ ok: true }`
2. `https://<railway-domain>/api/posts` returns list JSON
3. Vercel homepage shows post cards
4. Post detail page opens from card click
5. Browser network shows successful calls to Railway API
